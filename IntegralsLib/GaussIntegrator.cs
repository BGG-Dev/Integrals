using MathNet.Numerics;

namespace IntegralsLib
{
    /// <summary>
    /// Gauss integration implementation
    /// </summary>
    public class GaussIntegrator : IIntegrator
    {
        private class GaussPoint
        {
            public double[] Abscissas { get; }

            public double[] Weights { get; }

            internal int Order { get; }

            private GaussPoint(int order, double[] abscissas, double[] weights)
            {
                Abscissas = abscissas;
                Weights = weights;
                Order = order;
            }

            public static GaussPoint Generate(int order, double eps)
            {
                double[] array = new double[1024]
                {
                0.0,
                0.0,
                0.5,
                0.66666666666666674,
                0.75,
                0.8,
                5.0 / 6.0,
                0.85714285714285721,
                0.875,
                8.0 / 9.0,
                0.9,
                0.90909090909090906,
                11.0 / 12.0,
                0.92307692307692313,
                13.0 / 14.0,
                14.0 / 15.0,
                0.9375,
                0.94117647058823528,
                17.0 / 18.0,
                0.94736842105263164,
                0.95,
                20.0 / 21.0,
                21.0 / 22.0,
                0.95652173913043481,
                23.0 / 24.0,
                0.96,
                25.0 / 26.0,
                0.962962962962963,
                27.0 / 28.0,
                0.96551724137931039,
                29.0 / 30.0,
                0.967741935483871,
                31.0 / 32.0,
                32.0 / 33.0,
                33.0 / 34.0,
                34.0 / 35.0,
                35.0 / 36.0,
                0.972972972972973,
                37.0 / 38.0,
                38.0 / 39.0,
                0.975,
                0.975609756097561,
                41.0 / 42.0,
                0.97674418604651159,
                43.0 / 44.0,
                44.0 / 45.0,
                45.0 / 46.0,
                0.97872340425531912,
                47.0 / 48.0,
                0.97959183673469385,
                0.98,
                50.0 / 51.0,
                51.0 / 52.0,
                0.98113207547169812,
                53.0 / 54.0,
                54.0 / 55.0,
                55.0 / 56.0,
                56.0 / 57.0,
                57.0 / 58.0,
                0.98305084745762716,
                59.0 / 60.0,
                0.98360655737704916,
                61.0 / 62.0,
                0.98412698412698418,
                63.0 / 64.0,
                64.0 / 65.0,
                65.0 / 66.0,
                0.9850746268656716,
                67.0 / 68.0,
                68.0 / 69.0,
                69.0 / 70.0,
                0.9859154929577465,
                71.0 / 72.0,
                0.98630136986301364,
                73.0 / 74.0,
                74.0 / 75.0,
                75.0 / 76.0,
                0.987012987012987,
                77.0 / 78.0,
                0.98734177215189878,
                0.9875,
                80.0 / 81.0,
                81.0 / 82.0,
                0.98795180722891562,
                83.0 / 84.0,
                84.0 / 85.0,
                85.0 / 86.0,
                86.0 / 87.0,
                87.0 / 88.0,
                0.9887640449438202,
                89.0 / 90.0,
                0.989010989010989,
                91.0 / 92.0,
                92.0 / 93.0,
                93.0 / 94.0,
                94.0 / 95.0,
                95.0 / 96.0,
                0.98969072164948457,
                97.0 / 98.0,
                98.0 / 99.0,
                0.99,
                0.99009900990099009,
                101.0 / 102.0,
                0.99029126213592233,
                103.0 / 104.0,
                104.0 / 105.0,
                105.0 / 106.0,
                0.99065420560747663,
                107.0 / 108.0,
                0.99082568807339455,
                109.0 / 110.0,
                110.0 / 111.0,
                111.0 / 112.0,
                0.99115044247787609,
                113.0 / 114.0,
                114.0 / 115.0,
                115.0 / 116.0,
                116.0 / 117.0,
                117.0 / 118.0,
                0.99159663865546221,
                119.0 / 120.0,
                0.99173553719008267,
                121.0 / 122.0,
                122.0 / 123.0,
                123.0 / 124.0,
                0.992,
                125.0 / 126.0,
                0.99212598425196852,
                127.0 / 128.0,
                128.0 / 129.0,
                129.0 / 130.0,
                0.99236641221374045,
                131.0 / 132.0,
                0.99248120300751874,
                133.0 / 134.0,
                134.0 / 135.0,
                135.0 / 136.0,
                0.99270072992700731,
                137.0 / 138.0,
                0.9928057553956835,
                139.0 / 140.0,
                140.0 / 141.0,
                141.0 / 142.0,
                0.993006993006993,
                143.0 / 144.0,
                144.0 / 145.0,
                145.0 / 146.0,
                146.0 / 147.0,
                147.0 / 148.0,
                0.99328859060402686,
                149.0 / 150.0,
                0.99337748344370858,
                151.0 / 152.0,
                152.0 / 153.0,
                153.0 / 154.0,
                154.0 / 155.0,
                155.0 / 156.0,
                0.99363057324840764,
                157.0 / 158.0,
                158.0 / 159.0,
                159.0 / 160.0,
                0.99378881987577639,
                161.0 / 162.0,
                0.99386503067484666,
                163.0 / 164.0,
                164.0 / 165.0,
                165.0 / 166.0,
                0.99401197604790414,
                167.0 / 168.0,
                0.99408284023668636,
                169.0 / 170.0,
                0.99415204678362579,
                171.0 / 172.0,
                0.9942196531791907,
                173.0 / 174.0,
                174.0 / 175.0,
                175.0 / 176.0,
                176.0 / 177.0,
                177.0 / 178.0,
                0.994413407821229,
                179.0 / 180.0,
                0.994475138121547,
                181.0 / 182.0,
                182.0 / 183.0,
                183.0 / 184.0,
                184.0 / 185.0,
                185.0 / 186.0,
                0.99465240641711228,
                187.0 / 188.0,
                188.0 / 189.0,
                189.0 / 190.0,
                0.99476439790575921,
                191.0 / 192.0,
                0.99481865284974091,
                193.0 / 194.0,
                194.0 / 195.0,
                195.0 / 196.0,
                0.99492385786802029,
                197.0 / 198.0,
                0.99497487437185927,
                0.995,
                200.0 / 201.0,
                201.0 / 202.0,
                0.99507389162561577,
                203.0 / 204.0,
                204.0 / 205.0,
                205.0 / 206.0,
                206.0 / 207.0,
                207.0 / 208.0,
                0.99521531100478466,
                209.0 / 210.0,
                0.995260663507109,
                211.0 / 212.0,
                212.0 / 213.0,
                213.0 / 214.0,
                214.0 / 215.0,
                215.0 / 216.0,
                0.99539170506912444,
                217.0 / 218.0,
                0.995433789954338,
                219.0 / 220.0,
                0.995475113122172,
                221.0 / 222.0,
                0.99551569506726456,
                223.0 / 224.0,
                224.0 / 225.0,
                225.0 / 226.0,
                0.99559471365638763,
                227.0 / 228.0,
                0.99563318777292575,
                229.0 / 230.0,
                230.0 / 231.0,
                231.0 / 232.0,
                0.99570815450643779,
                233.0 / 234.0,
                234.0 / 235.0,
                235.0 / 236.0,
                236.0 / 237.0,
                237.0 / 238.0,
                0.99581589958159,
                239.0 / 240.0,
                0.995850622406639,
                241.0 / 242.0,
                242.0 / 243.0,
                243.0 / 244.0,
                244.0 / 245.0,
                245.0 / 246.0,
                0.99595141700404854,
                247.0 / 248.0,
                248.0 / 249.0,
                0.996,
                0.99601593625498008,
                251.0 / 252.0,
                0.99604743083003955,
                253.0 / 254.0,
                254.0 / 255.0,
                255.0 / 256.0,
                0.99610894941634243,
                257.0 / 258.0,
                0.99613899613899615,
                259.0 / 260.0,
                260.0 / 261.0,
                261.0 / 262.0,
                0.99619771863117867,
                263.0 / 264.0,
                264.0 / 265.0,
                265.0 / 266.0,
                266.0 / 267.0,
                267.0 / 268.0,
                0.99628252788104088,
                269.0 / 270.0,
                0.996309963099631,
                271.0 / 272.0,
                272.0 / 273.0,
                273.0 / 274.0,
                274.0 / 275.0,
                275.0 / 276.0,
                0.99638989169675085,
                277.0 / 278.0,
                278.0 / 279.0,
                279.0 / 280.0,
                0.99644128113879,
                281.0 / 282.0,
                0.99646643109540634,
                283.0 / 284.0,
                284.0 / 285.0,
                285.0 / 286.0,
                0.99651567944250874,
                287.0 / 288.0,
                0.9965397923875432,
                289.0 / 290.0,
                290.0 / 291.0,
                291.0 / 292.0,
                0.9965870307167235,
                293.0 / 294.0,
                294.0 / 295.0,
                295.0 / 296.0,
                296.0 / 297.0,
                297.0 / 298.0,
                0.99665551839464883,
                299.0 / 300.0,
                0.99667774086378735,
                301.0 / 302.0,
                302.0 / 303.0,
                303.0 / 304.0,
                304.0 / 305.0,
                305.0 / 306.0,
                0.996742671009772,
                307.0 / 308.0,
                308.0 / 309.0,
                309.0 / 310.0,
                0.99678456591639875,
                311.0 / 312.0,
                0.99680511182108622,
                313.0 / 314.0,
                314.0 / 315.0,
                315.0 / 316.0,
                0.99684542586750791,
                317.0 / 318.0,
                0.99686520376175547,
                319.0 / 320.0,
                320.0 / 321.0,
                321.0 / 322.0,
                0.99690402476780182,
                323.0 / 324.0,
                324.0 / 325.0,
                325.0 / 326.0,
                326.0 / 327.0,
                327.0 / 328.0,
                0.99696048632218848,
                329.0 / 330.0,
                0.99697885196374625,
                331.0 / 332.0,
                332.0 / 333.0,
                333.0 / 334.0,
                334.0 / 335.0,
                335.0 / 336.0,
                0.9970326409495549,
                337.0 / 338.0,
                338.0 / 339.0,
                339.0 / 340.0,
                0.99706744868035191,
                341.0 / 342.0,
                0.99708454810495628,
                343.0 / 344.0,
                344.0 / 345.0,
                345.0 / 346.0,
                0.99711815561959649,
                347.0 / 348.0,
                0.997134670487106,
                349.0 / 350.0,
                350.0 / 351.0,
                351.0 / 352.0,
                0.99716713881019825,
                353.0 / 354.0,
                354.0 / 355.0,
                355.0 / 356.0,
                356.0 / 357.0,
                357.0 / 358.0,
                0.99721448467966578,
                359.0 / 360.0,
                0.997229916897507,
                361.0 / 362.0,
                362.0 / 363.0,
                363.0 / 364.0,
                364.0 / 365.0,
                365.0 / 366.0,
                0.997275204359673,
                367.0 / 368.0,
                368.0 / 369.0,
                369.0 / 370.0,
                0.99730458221024254,
                371.0 / 372.0,
                0.99731903485254692,
                373.0 / 374.0,
                374.0 / 375.0,
                375.0 / 376.0,
                0.99734748010610075,
                377.0 / 378.0,
                0.99736147757255933,
                379.0 / 380.0,
                380.0 / 381.0,
                381.0 / 382.0,
                0.99738903394255873,
                383.0 / 384.0,
                384.0 / 385.0,
                385.0 / 386.0,
                386.0 / 387.0,
                387.0 / 388.0,
                0.99742930591259638,
                389.0 / 390.0,
                0.99744245524296671,
                391.0 / 392.0,
                392.0 / 393.0,
                393.0 / 394.0,
                394.0 / 395.0,
                395.0 / 396.0,
                0.9974811083123426,
                397.0 / 398.0,
                0.99749373433583965,
                0.9975,
                0.99750623441396513,
                401.0 / 402.0,
                0.9975186104218362,
                403.0 / 404.0,
                404.0 / 405.0,
                405.0 / 406.0,
                0.99754299754299758,
                407.0 / 408.0,
                0.99755501222493892,
                409.0 / 410.0,
                410.0 / 411.0,
                411.0 / 412.0,
                0.99757869249394671,
                413.0 / 414.0,
                414.0 / 415.0,
                415.0 / 416.0,
                416.0 / 417.0,
                417.0 / 418.0,
                0.99761336515513122,
                419.0 / 420.0,
                0.997624703087886,
                421.0 / 422.0,
                422.0 / 423.0,
                423.0 / 424.0,
                424.0 / 425.0,
                425.0 / 426.0,
                0.99765807962529274,
                427.0 / 428.0,
                428.0 / 429.0,
                429.0 / 430.0,
                0.99767981438515085,
                431.0 / 432.0,
                0.99769053117782913,
                433.0 / 434.0,
                434.0 / 435.0,
                435.0 / 436.0,
                0.99771167048054921,
                437.0 / 438.0,
                0.99772209567198178,
                439.0 / 440.0,
                440.0 / 441.0,
                441.0 / 442.0,
                0.99774266365688491,
                443.0 / 444.0,
                444.0 / 445.0,
                445.0 / 446.0,
                446.0 / 447.0,
                447.0 / 448.0,
                0.99777282850779514,
                449.0 / 450.0,
                0.99778270509977829,
                451.0 / 452.0,
                452.0 / 453.0,
                453.0 / 454.0,
                454.0 / 455.0,
                455.0 / 456.0,
                0.99781181619256021,
                457.0 / 458.0,
                458.0 / 459.0,
                459.0 / 460.0,
                0.99783080260303691,
                461.0 / 462.0,
                0.99784017278617709,
                463.0 / 464.0,
                464.0 / 465.0,
                465.0 / 466.0,
                0.99785867237687365,
                467.0 / 468.0,
                0.997867803837953,
                469.0 / 470.0,
                470.0 / 471.0,
                471.0 / 472.0,
                0.9978858350951374,
                473.0 / 474.0,
                474.0 / 475.0,
                475.0 / 476.0,
                476.0 / 477.0,
                477.0 / 478.0,
                0.9979123173277662,
                479.0 / 480.0,
                0.997920997920998,
                481.0 / 482.0,
                482.0 / 483.0,
                483.0 / 484.0,
                484.0 / 485.0,
                485.0 / 486.0,
                0.997946611909651,
                487.0 / 488.0,
                488.0 / 489.0,
                489.0 / 490.0,
                0.99796334012219956,
                491.0 / 492.0,
                0.99797160243407712,
                493.0 / 494.0,
                494.0 / 495.0,
                495.0 / 496.0,
                0.99798792756539234,
                497.0 / 498.0,
                0.99799599198396793,
                0.998,
                500.0 / 501.0,
                501.0 / 502.0,
                0.99801192842942343,
                503.0 / 504.0,
                504.0 / 505.0,
                505.0 / 506.0,
                506.0 / 507.0,
                507.0 / 508.0,
                0.99803536345776034,
                509.0 / 510.0,
                0.99804305283757344,
                511.0 / 512.0,
                512.0 / 513.0,
                513.0 / 514.0,
                514.0 / 515.0,
                515.0 / 516.0,
                0.99806576402321079,
                517.0 / 518.0,
                518.0 / 519.0,
                519.0 / 520.0,
                0.99808061420345484,
                521.0 / 522.0,
                0.99808795411089868,
                523.0 / 524.0,
                524.0 / 525.0,
                525.0 / 526.0,
                0.99810246679316883,
                527.0 / 528.0,
                0.998109640831758,
                529.0 / 530.0,
                530.0 / 531.0,
                531.0 / 532.0,
                0.99812382739212,
                533.0 / 534.0,
                534.0 / 535.0,
                535.0 / 536.0,
                536.0 / 537.0,
                537.0 / 538.0,
                0.99814471243042668,
                539.0 / 540.0,
                0.99815157116451014,
                541.0 / 542.0,
                542.0 / 543.0,
                543.0 / 544.0,
                544.0 / 545.0,
                545.0 / 546.0,
                0.9981718464351006,
                547.0 / 548.0,
                548.0 / 549.0,
                549.0 / 550.0,
                0.99818511796733211,
                551.0 / 552.0,
                0.99819168173598549,
                553.0 / 554.0,
                554.0 / 555.0,
                555.0 / 556.0,
                0.99820466786355477,
                557.0 / 558.0,
                0.998211091234347,
                559.0 / 560.0,
                560.0 / 561.0,
                561.0 / 562.0,
                0.9982238010657194,
                563.0 / 564.0,
                564.0 / 565.0,
                565.0 / 566.0,
                0.998236331569665,
                567.0 / 568.0,
                0.99824253075571179,
                569.0 / 570.0,
                0.99824868651488619,
                571.0 / 572.0,
                572.0 / 573.0,
                573.0 / 574.0,
                574.0 / 575.0,
                575.0 / 576.0,
                0.99826689774696709,
                577.0 / 578.0,
                578.0 / 579.0,
                579.0 / 580.0,
                0.99827882960413084,
                581.0 / 582.0,
                0.99828473413379071,
                583.0 / 584.0,
                584.0 / 585.0,
                585.0 / 586.0,
                0.99829642248722317,
                587.0 / 588.0,
                0.99830220713073,
                589.0 / 590.0,
                590.0 / 591.0,
                591.0 / 592.0,
                0.99831365935919059,
                593.0 / 594.0,
                594.0 / 595.0,
                595.0 / 596.0,
                596.0 / 597.0,
                597.0 / 598.0,
                0.998330550918197,
                599.0 / 600.0,
                0.99833610648918469,
                601.0 / 602.0,
                602.0 / 603.0,
                603.0 / 604.0,
                604.0 / 605.0,
                605.0 / 606.0,
                0.99835255354200991,
                607.0 / 608.0,
                608.0 / 609.0,
                609.0 / 610.0,
                0.99836333878887074,
                611.0 / 612.0,
                0.99836867862969,
                613.0 / 614.0,
                614.0 / 615.0,
                615.0 / 616.0,
                0.99837925445705022,
                617.0 / 618.0,
                0.99838449111470118,
                619.0 / 620.0,
                620.0 / 621.0,
                621.0 / 622.0,
                0.9983948635634029,
                623.0 / 624.0,
                0.9984,
                625.0 / 626.0,
                626.0 / 627.0,
                627.0 / 628.0,
                0.99841017488076311,
                629.0 / 630.0,
                0.99841521394611732,
                631.0 / 632.0,
                632.0 / 633.0,
                633.0 / 634.0,
                634.0 / 635.0,
                635.0 / 636.0,
                0.99843014128728413,
                637.0 / 638.0,
                638.0 / 639.0,
                639.0 / 640.0,
                0.99843993759750393,
                641.0 / 642.0,
                0.99844479004665632,
                643.0 / 644.0,
                644.0 / 645.0,
                645.0 / 646.0,
                0.99845440494590421,
                647.0 / 648.0,
                0.99845916795069334,
                649.0 / 650.0,
                650.0 / 651.0,
                651.0 / 652.0,
                0.998468606431853,
                653.0 / 654.0,
                654.0 / 655.0,
                655.0 / 656.0,
                656.0 / 657.0,
                657.0 / 658.0,
                0.99848254931714719,
                659.0 / 660.0,
                0.99848714069591527,
                661.0 / 662.0,
                662.0 / 663.0,
                663.0 / 664.0,
                664.0 / 665.0,
                665.0 / 666.0,
                0.99850074962518742,
                667.0 / 668.0,
                668.0 / 669.0,
                669.0 / 670.0,
                0.99850968703427723,
                671.0 / 672.0,
                0.99851411589895989,
                673.0 / 674.0,
                674.0 / 675.0,
                675.0 / 676.0,
                0.99852289512555392,
                677.0 / 678.0,
                0.99852724594992637,
                679.0 / 680.0,
                680.0 / 681.0,
                681.0 / 682.0,
                0.99853587115666176,
                683.0 / 684.0,
                684.0 / 685.0,
                685.0 / 686.0,
                686.0 / 687.0,
                687.0 / 688.0,
                0.99854862119013066,
                689.0 / 690.0,
                0.9985528219971056,
                691.0 / 692.0,
                692.0 / 693.0,
                693.0 / 694.0,
                694.0 / 695.0,
                695.0 / 696.0,
                0.99856527977044474,
                697.0 / 698.0,
                698.0 / 699.0,
                699.0 / 700.0,
                0.99857346647646217,
                701.0 / 702.0,
                0.99857752489331442,
                703.0 / 704.0,
                704.0 / 705.0,
                705.0 / 706.0,
                0.99858557284299854,
                707.0 / 708.0,
                0.998589562764457,
                709.0 / 710.0,
                710.0 / 711.0,
                711.0 / 712.0,
                0.99859747545582045,
                713.0 / 714.0,
                714.0 / 715.0,
                715.0 / 716.0,
                716.0 / 717.0,
                717.0 / 718.0,
                0.99860917941585536,
                719.0 / 720.0,
                0.9986130374479889,
                721.0 / 722.0,
                722.0 / 723.0,
                723.0 / 724.0,
                724.0 / 725.0,
                725.0 / 726.0,
                0.99862448418156813,
                727.0 / 728.0,
                728.0 / 729.0,
                729.0 / 730.0,
                0.99863201094391241,
                731.0 / 732.0,
                0.99863574351978168,
                733.0 / 734.0,
                734.0 / 735.0,
                735.0 / 736.0,
                0.99864314789687925,
                737.0 / 738.0,
                0.99864682002706362,
                739.0 / 740.0,
                740.0 / 741.0,
                741.0 / 742.0,
                0.99865410497981155,
                743.0 / 744.0,
                744.0 / 745.0,
                745.0 / 746.0,
                746.0 / 747.0,
                747.0 / 748.0,
                0.99866488651535379,
                749.0 / 750.0,
                0.99866844207723038,
                751.0 / 752.0,
                752.0 / 753.0,
                753.0 / 754.0,
                754.0 / 755.0,
                755.0 / 756.0,
                0.99867899603698806,
                757.0 / 758.0,
                758.0 / 759.0,
                759.0 / 760.0,
                0.99868593955321949,
                761.0 / 762.0,
                0.9986893840104849,
                763.0 / 764.0,
                764.0 / 765.0,
                765.0 / 766.0,
                0.99869621903520212,
                767.0 / 768.0,
                0.99869960988296491,
                769.0 / 770.0,
                770.0 / 771.0,
                771.0 / 772.0,
                0.99870633893919791,
                773.0 / 774.0,
                774.0 / 775.0,
                775.0 / 776.0,
                776.0 / 777.0,
                777.0 / 778.0,
                0.99871630295250324,
                779.0 / 780.0,
                0.998719590268886,
                781.0 / 782.0,
                782.0 / 783.0,
                783.0 / 784.0,
                784.0 / 785.0,
                785.0 / 786.0,
                0.99872935196950441,
                787.0 / 788.0,
                788.0 / 789.0,
                789.0 / 790.0,
                0.99873577749683939,
                791.0 / 792.0,
                0.99873896595208067,
                793.0 / 794.0,
                794.0 / 795.0,
                795.0 / 796.0,
                0.998745294855709,
                797.0 / 798.0,
                0.99874843554443049,
                799.0 / 800.0,
                800.0 / 801.0,
                801.0 / 802.0,
                0.99875466998754669,
                803.0 / 804.0,
                804.0 / 805.0,
                805.0 / 806.0,
                806.0 / 807.0,
                807.0 / 808.0,
                0.99876390605686027,
                809.0 / 810.0,
                0.998766954377312,
                811.0 / 812.0,
                812.0 / 813.0,
                813.0 / 814.0,
                814.0 / 815.0,
                815.0 / 816.0,
                0.99877600979192172,
                817.0 / 818.0,
                818.0 / 819.0,
                819.0 / 820.0,
                0.99878197320341044,
                821.0 / 822.0,
                0.99878493317132444,
                823.0 / 824.0,
                824.0 / 825.0,
                825.0 / 826.0,
                0.99879081015719473,
                827.0 / 828.0,
                0.99879372738238847,
                829.0 / 830.0,
                830.0 / 831.0,
                831.0 / 832.0,
                0.99879951980792314,
                833.0 / 834.0,
                834.0 / 835.0,
                835.0 / 836.0,
                836.0 / 837.0,
                837.0 / 838.0,
                0.99880810488677,
                839.0 / 840.0,
                0.99881093935790721,
                841.0 / 842.0,
                842.0 / 843.0,
                843.0 / 844.0,
                844.0 / 845.0,
                845.0 / 846.0,
                0.99881936245572611,
                847.0 / 848.0,
                848.0 / 849.0,
                849.0 / 850.0,
                0.99882491186839018,
                851.0 / 852.0,
                0.9988276670574443,
                853.0 / 854.0,
                854.0 / 855.0,
                855.0 / 856.0,
                0.99883313885647607,
                857.0 / 858.0,
                0.99883585564610011,
                859.0 / 860.0,
                860.0 / 861.0,
                861.0 / 862.0,
                0.99884125144843572,
                863.0 / 864.0,
                864.0 / 865.0,
                865.0 / 866.0,
                866.0 / 867.0,
                867.0 / 868.0,
                0.998849252013809,
                869.0 / 870.0,
                0.99885189437428246,
                871.0 / 872.0,
                872.0 / 873.0,
                873.0 / 874.0,
                874.0 / 875.0,
                875.0 / 876.0,
                0.9988597491448119,
                877.0 / 878.0,
                878.0 / 879.0,
                879.0 / 880.0,
                0.99886492622020429,
                881.0 / 882.0,
                0.9988674971687429,
                883.0 / 884.0,
                884.0 / 885.0,
                885.0 / 886.0,
                0.99887260428410374,
                887.0 / 888.0,
                0.99887514060742411,
                889.0 / 890.0,
                890.0 / 891.0,
                891.0 / 892.0,
                0.99888017917133254,
                893.0 / 894.0,
                894.0 / 895.0,
                895.0 / 896.0,
                896.0 / 897.0,
                897.0 / 898.0,
                0.99888765294771964,
                899.0 / 900.0,
                0.99889012208657046,
                901.0 / 902.0,
                902.0 / 903.0,
                903.0 / 904.0,
                904.0 / 905.0,
                905.0 / 906.0,
                0.9988974641675854,
                907.0 / 908.0,
                908.0 / 909.0,
                909.0 / 910.0,
                0.99890230515916578,
                911.0 / 912.0,
                0.99890470974808321,
                913.0 / 914.0,
                914.0 / 915.0,
                915.0 / 916.0,
                0.99890948745910579,
                917.0 / 918.0,
                0.998911860718172,
                919.0 / 920.0,
                920.0 / 921.0,
                921.0 / 922.0,
                0.99891657638136511,
                923.0 / 924.0,
                924.0 / 925.0,
                925.0 / 926.0,
                926.0 / 927.0,
                927.0 / 928.0,
                0.99892357373519913,
                929.0 / 930.0,
                0.9989258861439313,
                931.0 / 932.0,
                932.0 / 933.0,
                933.0 / 934.0,
                934.0 / 935.0,
                935.0 / 936.0,
                0.99893276414087517,
                937.0 / 938.0,
                938.0 / 939.0,
                939.0 / 940.0,
                0.99893730074388953,
                941.0 / 942.0,
                0.99893955461293749,
                943.0 / 944.0,
                944.0 / 945.0,
                945.0 / 946.0,
                0.99894403379091867,
                947.0 / 948.0,
                0.99894625922023184,
                949.0 / 950.0,
                950.0 / 951.0,
                951.0 / 952.0,
                0.99895068205666315,
                953.0 / 954.0,
                954.0 / 955.0,
                955.0 / 956.0,
                956.0 / 957.0,
                957.0 / 958.0,
                0.99895724713242962,
                959.0 / 960.0,
                0.99895941727367321,
                961.0 / 962.0,
                962.0 / 963.0,
                963.0 / 964.0,
                964.0 / 965.0,
                965.0 / 966.0,
                0.99896587383660806,
                967.0 / 968.0,
                968.0 / 969.0,
                969.0 / 970.0,
                0.99897013388259526,
                971.0 / 972.0,
                0.998972250770812,
                973.0 / 974.0,
                974.0 / 975.0,
                975.0 / 976.0,
                0.99897645854657113,
                977.0 / 978.0,
                0.99897854954034726,
                979.0 / 980.0,
                980.0 / 981.0,
                981.0 / 982.0,
                0.99898270600203454,
                983.0 / 984.0,
                984.0 / 985.0,
                985.0 / 986.0,
                986.0 / 987.0,
                987.0 / 988.0,
                0.99898887765419619,
                989.0 / 990.0,
                0.99899091826437947,
                991.0 / 992.0,
                992.0 / 993.0,
                993.0 / 994.0,
                994.0 / 995.0,
                995.0 / 996.0,
                0.99899699097291872,
                997.0 / 998.0,
                998.0 / 999.0,
                0.999,
                0.999000999000999,
                0.999001996007984,
                0.99900299102691925,
                0.999003984063745,
                0.99900497512437814,
                0.99900596421471177,
                0.99900695134061568,
                0.99900793650793651,
                0.9990089197224975,
                0.999009900990099,
                0.9990108803165183,
                0.99901185770750989,
                0.99901283316880551,
                0.99901380670611439,
                0.9990147783251232,
                0.99901574803149606,
                0.99901671583087515,
                0.99901768172888017,
                0.99901864573110888,
                0.99901960784313726,
                0.99902056807051909,
                0.99902152641878672,
                0.99902248289345064
                };
                double num = 0.0;
                int num2 = order + 1 >> 1;
                double[] array2 = new double[num2];
                double[] array3 = new double[num2];
                double num3 = 1.0 - (1.0 - 1.0 / (double)order) / (8.0 * (double)order * (double)order);
                double num4 = 1.0 / (4.0 * (double)order + 2.0);
                for (int i = 1; i <= num2; i++)
                {
                    int num5 = 0;
                    double num6 = Math.Cos(Math.PI * (double)((i << 2) - 1) * num4) * num3;
                    double num13;
                    double num14;
                    double value;
                    double value2;
                    do
                    {
                        double num7 = 1.0;
                        double num8 = num6;
                        if (order < 1024)
                        {
                            for (int j = 2; j <= order; j++)
                            {
                                double num9 = num7;
                                num7 = num8;
                                double num10 = num6 * num7;
                                num8 = num10 + array[j] * (num10 - num9);
                            }
                        }
                        else
                        {
                            for (int j = 2; j < 1024; j++)
                            {
                                double num9 = num7;
                                num7 = num8;
                                double num10 = num6 * num7;
                                num8 = num10 + array[j] * (num10 - num9);
                            }

                            for (int j = 1024; j <= order; j++)
                            {
                                double num9 = num7;
                                num7 = num8;
                                double num10 = num6 * num7;
                                double num11 = ((double)j - 1.0) / (double)j;
                                num8 = num10 + num11 * (num10 - num9);
                            }
                        }

                        double num12 = (num6 * num8 - num7) * (double)order / (num6 * num6 - 1.0);
                        num13 = num6 - num8 / num12;
                        num14 = 2.0 / ((1.0 - num13 * num13) * num12 * num12);
                        if (num5 == 0)
                        {
                            num = 2.0 / ((1.0 - num6 * num6) * num12 * num12);
                        }

                        value = num6 - num13;
                        value2 = num - num14;
                        num6 = num13;
                        num = num14;
                        num5++;
                    }
                    while ((Math.Abs(value) > eps || Math.Abs(value2) > eps) && num5 < 100);
                    int num15 = num2 - 1 - (i - 1);
                    array2[num15] = num13;
                    array3[num15] = num14;
                }

                return new GaussPoint(order, array2, array3);
            }
        }

        private const int order = 128;

        /// <summary>
        /// Method - integration contract implementation
        /// </summary>
        /// <param name="f"> function to integrate </param>
        /// <param name="a"> min </param>
        /// <param name="b"> max </param>
        /// <param name="epsilon"> precision used to calculate h and n</param>
        /// <returns> numeric integral value </returns>
        public double Integrate(Func<double, double> f, double a, double b, double epsilon)
        {
            return Integrate11((double t) => f((b - a) / 4.0 * t * (3.0 - t * t) + (b + a) / 2.0) * 3.0 * (b - a) / 4.0 * (1.0 - t * t), epsilon);
        }

        /// <summary>
        /// Runs Gauss integration for [-1; 1]
        /// </summary>
        /// <param name="f"> function to integrate on [-1; 1] </param>
        /// <param name="epsilon"> precision </param>
        /// <returns> numeric integral value </returns>
        private double Integrate11(Func<double, double> f, double epsilon)
        {
            GaussPoint gaussPoint = GaussPoint.Generate(order, epsilon);
            int num = order + 1 >> 1;
            double num2 = 0.5 * 2;
            double num3 = 0;
            double[] weights = gaussPoint.Weights;
            double[] abscissas = gaussPoint.Abscissas;
            double num4;
            if (order.IsOdd())
            {
                num4 = weights[0] * f(num3);
                for (int i = 1; i < num; i++)
                {
                    double num5 = num2 * abscissas[i];
                    num4 += weights[i] * (f(num3 + num5) + f(num3 - num5));
                }
            }
            else
            {
                num4 = 0.0;
                for (int i = 0; i < num; i++)
                {
                    double num5 = num2 * abscissas[i];
                    num4 += weights[i] * (f(num3 + num5) + f(num3 - num5));
                }
            }

            return num2 * num4;
        }
    }
}
